<script>
    window.onload = function () {
        const schoolId = "your_school_id_here"; // Replace with the School API _id
        const contextId = "your_context_id_here"; // Replace with the Context API _id
        fetchData(schoolId, contextId);
    };

    async function fetchData(schoolId, contextId) {
        // API Endpoints
        const schoolApiUrl = 'http://localhost:3000/api/formdata'; // Replace with your school API endpoint
        const contextApiUrl = 'http://localhost:3000/api/formdatacontext'; // Replace with your context API endpoint

        // Fetch school data
        const schoolResponse = await fetch(schoolApiUrl);
        const schoolData = await schoolResponse.json();
        const schoolEntry = schoolData.find(item => item._id === schoolId);

        // Fetch context data
        const contextResponse = await fetch(contextApiUrl);
        const contextData = await contextResponse.json();
        const contextEntry = contextData.find(item => item._id === contextId);

        function updateOrHide(id, value) {
            const element = document.getElementById(id);
            if (element) {
                if (value) {
                    if (element.tagName === 'IMG') {
                        element.src = value; // Update `src` for images
                    } else {
                        element.textContent = value; // Update text content
                    }
                    element.style.display = ''; // Ensure the element is visible
                } else {
                    element.style.display = 'none'; // Hide the element if value is null or empty
                }
            }
        }
        if (schoolEntry) {
            

        // General Information
        updateOrHide('generalInformation.areaOfWork', targetEntry.generalInformation?.areaOfWork);
        updateOrHide('generalInformation.city', targetEntry.generalInformation?.city);
        updateOrHide('generalInformation.county', targetEntry.generalInformation?.county);
        updateOrHide('generalInformation.neighborhood', targetEntry.generalInformation?.neighborhood);
        updateOrHide('generalInformation.state', targetEntry.generalInformation?.state);

        // Contacts
        updateOrHide('contacts.contactPerson.name', targetEntry.contacts?.contactPerson?.name);
        updateOrHide('contacts.contactPerson.email', targetEntry.contacts?.contactPerson?.email);
        updateOrHide('contacts.contactPerson.phone', targetEntry.contacts?.contactPerson?.phone);
        updateOrHide('contacts.organization.name', targetEntry.contacts?.organization?.name);
        updateOrHide('contacts.organization.type', targetEntry.contacts?.organization?.type);

        // Contributors
        for (let i = 1; i <= 5; i++) {
            updateOrHide(`contacts.contributors.contributor${i}.organization`, targetEntry.contacts?.contributors[`contributor${i}`]?.organization);
            updateOrHide(`contacts.contributors.contributor${i}.type`, targetEntry.contacts?.contributors[`contributor${i}`]?.type);
        }

        // School Details
        updateOrHide('school.name', targetEntry.school?.name);
        updateOrHide('school.location', targetEntry.school?.location);
        updateOrHide('school.address', targetEntry.school?.address);
        updateOrHide('school.city', targetEntry.school?.city);
        updateOrHide('school.county', targetEntry.school?.county);
        updateOrHide('school.neighborhood', targetEntry.school?.neighborhood);
        updateOrHide('school.state', targetEntry.school?.state);
        updateOrHide('school.currentUse', targetEntry.school?.currentUse);
        updateOrHide('school.condition', targetEntry.school?.condition);
        updateOrHide('school.landmarked', targetEntry.school?.landmarked);
        updateOrHide('school.landmarkedBy', targetEntry.school?.landmarkedBy);
        updateOrHide('school.sign', targetEntry.school?.sign);
        updateOrHide('school.owner', targetEntry.school?.owner);

        // Other Names
        for (let i = 1; i <= 5; i++) {
            updateOrHide(`school.otherNames.name${i}`, targetEntry.school?.otherNames[`name${i}`]);
        }

        // School Description
        updateOrHide('school.description.yearInstitutionCreation', targetEntry.school?.description?.yearInstitutionCreation);
        updateOrHide('school.description.yearBuildingStarted', targetEntry.school?.description?.yearBuildingStarted);
        updateOrHide('school.description.yearBuildingEnded', targetEntry.school?.description?.yearBuildingEnded);
        updateOrHide('school.description.yearDesegregation', targetEntry.school?.description?.yearDesegregation);
        updateOrHide('school.description.yearCeased', targetEntry.school?.description?.yearCeased);
        updateOrHide('school.description.yearDemolished', targetEntry.school?.description?.yearDemolished);
        updateOrHide('school.description.briefDescription', targetEntry.school?.description?.briefDescription);
        updateOrHide('school.description.sources', targetEntry.school?.description?.sources);
        updateOrHide('school.description.footnote', targetEntry.school?.description?.footnote);
        updateOrHide('school.description.imageSources', targetEntry.school?.description?.imageSources);
        updateOrHide('school.description.image', targetEntry.school?.description?.image);

        // Timeline Events
        for (let i = 1; i <= 10; i++) {
            updateOrHide(`school.timeline.event${i}.title`, targetEntry.school?.timeline[`event${i}`]?.title);
            updateOrHide(`school.timeline.event${i}.year`, targetEntry.school?.timeline[`event${i}`]?.year);
            updateOrHide(`school.timeline.event${i}.briefDescription`, targetEntry.school?.timeline[`event${i}`]?.briefDescription);
            updateOrHide(`school.timeline.event${i}.sources`, targetEntry.school?.timeline[`event${i}`]?.sources);
            updateOrHide(`school.timeline.event${i}.footnote`, targetEntry.school?.timeline[`event${i}`]?.footnote);
            updateOrHide(`school.timeline.event${i}.image`, targetEntry.school?.timeline[`event${i}`]?.image);
        }

        // Relevant Figures
        for (let i = 1; i <= 5; i++) {
            updateOrHide(`relevantFigures.figure${i}.name`, targetEntry.relevantFigures?.[`figure${i}`]?.name);
            updateOrHide(`relevantFigures.figure${i}.years`, targetEntry.relevantFigures?.[`figure${i}`]?.years);
            updateOrHide(`relevantFigures.figure${i}.role`, targetEntry.relevantFigures?.[`figure${i}`]?.role);
            updateOrHide(`relevantFigures.figure${i}.roleYears`, targetEntry.relevantFigures?.[`figure${i}`]?.roleYears);
            updateOrHide(`relevantFigures.figure${i}.briefDescription`, targetEntry.relevantFigures?.[`figure${i}`]?.briefDescription);
            updateOrHide(`relevantFigures.figure${i}.sources`, targetEntry.relevantFigures?.[`figure${i}`]?.sources);
            updateOrHide(`relevantFigures.figure${i}.footnote`, targetEntry.relevantFigures?.[`figure${i}`]?.footnote);
            updateOrHide(`relevantFigures.figure${i}.image`, targetEntry.relevantFigures?.[`figure${i}`]?.image);
        }

        // Maps
        for (let i = 1; i <= 10; i++) {
            updateOrHide(`maps.map${i}.title`, targetEntry.maps?.[`map${i}`]?.title);
            updateOrHide(`maps.map${i}.decade`, targetEntry.maps?.[`map${i}`]?.decade);
            updateOrHide(`maps.map${i}.briefDescription`, targetEntry.maps?.[`map${i}`]?.briefDescription);
            updateOrHide(`maps.map${i}.sources`, targetEntry.maps?.[`map${i}`]?.sources);
            updateOrHide(`maps.map${i}.footnote`, targetEntry.maps?.[`map${i}`]?.footnote);
            updateOrHide(`maps.map${i}.imageSources`, targetEntry.maps?.[`map${i}`]?.imageSources);
            updateOrHide(`maps.map${i}.image`, targetEntry.maps?.[`map${i}`]?.image);
        }
        }
        if (contextEntry) {
            // Updating or hiding general information fields
            updateOrHide('ctxt.generalInformation.areaOfWork', ctxtEntry.generalInformation.areaOfWork);
            updateOrHide('ctxt.generalInformation.city', ctxtEntry.generalInformation.city);
            updateOrHide('ctxt.generalInformation.county', ctxtEntry.generalInformation.county);
            updateOrHide('ctxt.generalInformation.neighborhood', ctxtEntry.generalInformation.neighborhood);
            updateOrHide('ctxt.generalInformation.state', ctxtEntry.generalInformation.state);

            // Updating or hiding timeline fields
            for (let i = 1; i <= 10; i++) {
                updateOrHide(`ctxt.timeline.event${i}.title`, ctxtEntry.timeline[`event${i}`]?.title);
                updateOrHide(`ctxt.timeline.event${i}.year`, ctxtEntry.timeline[`event${i}`]?.year);
                updateOrHide(`ctxt.timeline.event${i}.briefDescription`, ctxtEntry.timeline[`event${i}`]?.briefDescription);
                updateOrHide(`ctxt.timeline.event${i}.sources`, ctxtEntry.timeline[`event${i}`]?.sources);
            }
            }

    }

    window.onload = fetchSchoolById;
</script>
