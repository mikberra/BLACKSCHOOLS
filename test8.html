<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Clean Blog - Start Bootstrap Theme</title>
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v6.3.0/js/all.js" crossorigin="anonymous"></script>
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
        <script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
        <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
        <style>
            body {
              background: url('./images/background.png') no-repeat center center fixed;
              background-size: cover; 
              margin: 0; 
              padding: 0; 
            }
          </style>
    </head>
    <body>
<!-- Navigation-->
    <nav class="navbar">
        <div class="t3">
            BLACK SCHOOLS
        </div>
        <div class="navbar-right">
            <button class="nav-button">Explore</button>
            <button class="nav-button">Contribute</button>
            <button class="nav-button">News</button>
        </div>
    </nav>
<!-- Masthead-->
    <div class="container-fluid px-0">
        <div class="row g-0 text-white">
            <!-- Left Column: 7/12 wide -->
            <div class="col-md-7 position-relative">
                <!-- Masthead Section -->
                <div class="masthead-overlay d-flex flex-column justify-content-end" style="background-image: url('./images/CS3_i1.png'); height: 80vh;">
                    <div class="text-overlay p-4">
                        <h4 id="school.address">Address</h4>
                        <t1 id="school.name">SCHOOL 1</t1>
                        <h5 id="school.condition">Characteristics</h5>
                    </div>
                </div>
                <!-- Description Section -->
                <div class="bg-dark text-white p-4">
                        <div id="school.description.briefDescription" class="mb-4">
                            <t3>Summary</t3>
                            <p>A small building surrounded by giants: it is how the former Colored School no. 3 feels today. The single-storey brick building in 270 Union Avenue, Williamsburg, is the only standing Colored School building in Brooklyn, and stands as a testament to the physical and social transformations that have reshaped the area.</p>
                        </div>
                    <div>
                        <t3>Notable People</t3>
                        <div class="row">
                            <div class="col-md-6">
                                <div class="avatar-card">
                                    <img class="avatar" id="relevantFigures.figure2.image" src="./images/1892,CatharineClow.jpg" alt="Avatar">
                                    <div class="avatar-text-content">
                                        <h5 id="relevantFigures.figure1.name" class="avatar-name">Catharine T. Clow</h5>
                                        <p id="relevantFigures.figure1.role" class="avatar-title">Principal</p>
                                        <p id="relevantFigures.figure1.briefDescription" class="avatar-description">Colored School 3, Brooklyn</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="avatar-card">
                                    <img class="avatar" id="relevantFigures.figure2.image" src="./images/1892,CatharineClow.jpg" alt="Avatar">
                                    <div class="avatar-text-content">
                                        <h5 id="relevantFigures.figure2.name" class="avatar-name">Philip A. White</h5>
                                        <p id="relevantFigures.figure2.role" class="avatar-title">Principal</p>
                                        <p id="relevantFigures.figure2.briefDescription" class="avatar-description">Colored School 3, Brooklyn</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Right Column: 5/12 wide -->
            <div class="col-md-5 position-relative">
                <!-- Mapbox Map as Background -->
                <div id="map" class="map-schools"></div>
                <script src="map.js"></script>
            </div>
        </div>
    </div>

<!-- Timeline-->
    <article class="mb-4 bg-primary">
        <div class="container-fluid px-4 px-lg-5">
            <div class="row">
                <t1>Timeline</t1>
            </div>
            <div class="row gx-4 gx-lg-5">
                <div class="col-md-7"></div>
                <div class="col-md-5 position-relative">
                    <div class="sticky-top-buttons">
                        <button id="buttonA" class="active" onclick="toggleContent('A')">Maps</button>
                        <button id="buttonB" onclick="toggleContent('B')">Historical context</button>
                    </div>
            </div>
    </article>
<!-- Decade 1 -->
<div id="timeline-container" class="container"></div>

<!-- Components-->   
    <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Core theme JS-->
        <script src="js/scripts.js"></script>    
    <!-- On-off button -->    
        <script>
            function toggleContent(content) {
                // Select all content elements
                const contentAElements = document.querySelectorAll('.contentA');
                const contentBElements = document.querySelectorAll('.contentB');
                
                // Select the buttons
                const buttonA = document.getElementById('buttonA');
                const buttonB = document.getElementById('buttonB');
        
                if (content === 'A') {
                    contentAElements.forEach(el => el.classList.remove('d-none'));
                    contentBElements.forEach(el => el.classList.add('d-none'));
                    buttonA.classList.add('active');
                    buttonB.classList.remove('active');
                } else if (content === 'B') {
                    contentAElements.forEach(el => el.classList.add('d-none'));
                    contentBElements.forEach(el => el.classList.remove('d-none'));
                    buttonA.classList.remove('active');
                    buttonB.classList.add('active');
                }
            }
        </script>


    <!-- Timeline elements script -->
        <script>
            const decades = 10; // Number of decades
            const container = document.getElementById("timeline-container");

            for (let i = 1; i <= decades; i++) {
                const html = `
                    <div class="row gx-4 gx-lg-5">
                        <!-- School event -->
                        <div class="col-md-7">
                            <section>
                                <div class="row align-items-center">
                                    <div class="col-md-2">
                                        <h3 id="school.timeline.event${i}.year" class="event-year"></h3>
                                    </div>
                                    <div class="col-md-10">
                                        <h2 id="school.timeline.event${i}.title"></h2>
                                    </div>
                                </div>
                                <div class="col-md-1"></div>
                                <div class="col-md-11 timeline-box">
                                    <p id="school.timeline.event${i}.briefDescription">Autofill-description</p>
                                    <p id="school.timeline.event${i}.sources"></p>
                                    <img id="school.timeline.event${i}.image" class="img-fluid" />
                                    <p id="school.timeline.event${i}.footnote"></p>
                                    <p id="school.timeline.event${i}.imageSources"></p>
                                </div>
                            </section>
                        </div>

                        <!-- Context map and event -->
                        <div class="col-md-5">
                            <!-- Context map -->
                            <div class="contentA mt-3">
                                <section class="parallax">
                                    <img id="maps.map${i}.image" alt="Parallax Background">
                                </section>
                            </div>
                            <!-- Context event -->
                            <div class="contentB mt-3 d-none text-dark">
                                <section>
                                    <div class="row align-items-center">
                                        <div class="col-md-2">
                                            <h4 id="ctxt.timeline.event${i}.year"></h4>
                                        </div>
                                        <div class="col-md-10">
                                            <h3 id="ctxt.timeline.event${i}.title"></h3>
                                        </div>
                                    </div>
                                    <div class="timeline-box">
                                        <p id="ctxt.timeline.event${i}.briefDescription"></p>
                                        <p id="ctxt.timeline.event${i}.sources"></p>
                                        <img id="ctxt.timeline.event${i}.image" class="img-fluid" />
                                        <p id="ctxt.timeline.event${i}.footnote"></p>
                                        <p id="ctxt.timeline.event${i}.imageSources"></p>
                                    </div>
                                </section>
                            </div>
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            }
        </script>

    <!-- Pulling all info script -->
        <script>
            window.onload = function () {
                const schoolId = "6754c7233eac10c4d575d570"; // Replace with the School API _id
                const contextId = "6754c7233eac10c4d575d570"; // Replace with the Context API _id
                fetchData(schoolId, contextId);
            };
        
            async function fetchData(schoolId, contextId) {
                // API Endpoints
                const schoolApiUrl = 'http://localhost:3000/api/formdata'; // Replace with your school API endpoint
                const contextApiUrl = 'http://localhost:3000/api/formdatacontext'; // Replace with your context API endpoint
        
                // Fetch school data
                const schoolResponse = await fetch(schoolApiUrl);
                const schoolData = await schoolResponse.json();
                const schoolEntry = schoolData.find(item => item._id === schoolId);
        
                // Fetch context data
                const contextResponse = await fetch(contextApiUrl);
                const contextData = await contextResponse.json();
                const contextEntry = contextData.find(item => item._id === contextId);
        
                function updateOrHide(id, value) {
                    const element = document.getElementById(id);
                    if (element) {
                        if (value) {
                            if (element.tagName === 'IMG') {
                                element.src = value; // Update `src` for images
                            } else {
                                element.textContent = value; // Update text content
                            }
                            element.style.display = ''; // Ensure the element is visible
                        } else {
                            element.style.display = 'none'; // Hide the element if value is null or empty
                        }
                    }
                }
                if (schoolEntry) {
                    
        
                // General Information
                updateOrHide('generalInformation.areaOfWork', targetEntry.generalInformation?.areaOfWork);
                updateOrHide('generalInformation.city', targetEntry.generalInformation?.city);
                updateOrHide('generalInformation.county', targetEntry.generalInformation?.county);
                updateOrHide('generalInformation.neighborhood', targetEntry.generalInformation?.neighborhood);
                updateOrHide('generalInformation.state', targetEntry.generalInformation?.state);
        
                // Contacts
                updateOrHide('contacts.contactPerson.name', targetEntry.contacts?.contactPerson?.name);
                updateOrHide('contacts.contactPerson.email', targetEntry.contacts?.contactPerson?.email);
                updateOrHide('contacts.contactPerson.phone', targetEntry.contacts?.contactPerson?.phone);
                updateOrHide('contacts.organization.name', targetEntry.contacts?.organization?.name);
                updateOrHide('contacts.organization.type', targetEntry.contacts?.organization?.type);
        
                // Contributors
                for (let i = 1; i <= 5; i++) {
                    updateOrHide(`contacts.contributors.contributor${i}.organization`, targetEntry.contacts?.contributors[`contributor${i}`]?.organization);
                    updateOrHide(`contacts.contributors.contributor${i}.type`, targetEntry.contacts?.contributors[`contributor${i}`]?.type);
                }
        
                // School Details
                updateOrHide('school.name', targetEntry.school?.name);
                updateOrHide('school.location', targetEntry.school?.location);
                updateOrHide('school.address', targetEntry.school?.address);
                updateOrHide('school.city', targetEntry.school?.city);
                updateOrHide('school.county', targetEntry.school?.county);
                updateOrHide('school.neighborhood', targetEntry.school?.neighborhood);
                updateOrHide('school.state', targetEntry.school?.state);
                updateOrHide('school.currentUse', targetEntry.school?.currentUse);
                updateOrHide('school.condition', targetEntry.school?.condition);
                updateOrHide('school.landmarked', targetEntry.school?.landmarked);
                updateOrHide('school.landmarkedBy', targetEntry.school?.landmarkedBy);
                updateOrHide('school.sign', targetEntry.school?.sign);
                updateOrHide('school.owner', targetEntry.school?.owner);
        
                // Other Names
                for (let i = 1; i <= 5; i++) {
                    updateOrHide(`school.otherNames.name${i}`, targetEntry.school?.otherNames[`name${i}`]);
                }
        
                // School Description
                updateOrHide('school.description.yearInstitutionCreation', targetEntry.school?.description?.yearInstitutionCreation);
                updateOrHide('school.description.yearBuildingStarted', targetEntry.school?.description?.yearBuildingStarted);
                updateOrHide('school.description.yearBuildingEnded', targetEntry.school?.description?.yearBuildingEnded);
                updateOrHide('school.description.yearDesegregation', targetEntry.school?.description?.yearDesegregation);
                updateOrHide('school.description.yearCeased', targetEntry.school?.description?.yearCeased);
                updateOrHide('school.description.yearDemolished', targetEntry.school?.description?.yearDemolished);
                updateOrHide('school.description.briefDescription', targetEntry.school?.description?.briefDescription);
                updateOrHide('school.description.sources', targetEntry.school?.description?.sources);
                updateOrHide('school.description.footnote', targetEntry.school?.description?.footnote);
                updateOrHide('school.description.imageSources', targetEntry.school?.description?.imageSources);
                updateOrHide('school.description.image', targetEntry.school?.description?.image);
        
                // Timeline Events
                for (let i = 1; i <= 10; i++) {
                    updateOrHide(`school.timeline.event${i}.title`, targetEntry.school?.timeline[`event${i}`]?.title);
                    updateOrHide(`school.timeline.event${i}.year`, targetEntry.school?.timeline[`event${i}`]?.year);
                    updateOrHide(`school.timeline.event${i}.briefDescription`, targetEntry.school?.timeline[`event${i}`]?.briefDescription);
                    updateOrHide(`school.timeline.event${i}.sources`, targetEntry.school?.timeline[`event${i}`]?.sources);
                    updateOrHide(`school.timeline.event${i}.footnote`, targetEntry.school?.timeline[`event${i}`]?.footnote);
                    updateOrHide(`school.timeline.event${i}.image`, targetEntry.school?.timeline[`event${i}`]?.image);
                }
        
                // Relevant Figures
                for (let i = 1; i <= 5; i++) {
                    updateOrHide(`relevantFigures.figure${i}.name`, targetEntry.relevantFigures?.[`figure${i}`]?.name);
                    updateOrHide(`relevantFigures.figure${i}.years`, targetEntry.relevantFigures?.[`figure${i}`]?.years);
                    updateOrHide(`relevantFigures.figure${i}.role`, targetEntry.relevantFigures?.[`figure${i}`]?.role);
                    updateOrHide(`relevantFigures.figure${i}.roleYears`, targetEntry.relevantFigures?.[`figure${i}`]?.roleYears);
                    updateOrHide(`relevantFigures.figure${i}.briefDescription`, targetEntry.relevantFigures?.[`figure${i}`]?.briefDescription);
                    updateOrHide(`relevantFigures.figure${i}.sources`, targetEntry.relevantFigures?.[`figure${i}`]?.sources);
                    updateOrHide(`relevantFigures.figure${i}.footnote`, targetEntry.relevantFigures?.[`figure${i}`]?.footnote);
                    updateOrHide(`relevantFigures.figure${i}.image`, targetEntry.relevantFigures?.[`figure${i}`]?.image);
                }
        
                // Maps
                for (let i = 1; i <= 10; i++) {
                    updateOrHide(`maps.map${i}.title`, targetEntry.maps?.[`map${i}`]?.title);
                    updateOrHide(`maps.map${i}.decade`, targetEntry.maps?.[`map${i}`]?.decade);
                    updateOrHide(`maps.map${i}.briefDescription`, targetEntry.maps?.[`map${i}`]?.briefDescription);
                    updateOrHide(`maps.map${i}.sources`, targetEntry.maps?.[`map${i}`]?.sources);
                    updateOrHide(`maps.map${i}.footnote`, targetEntry.maps?.[`map${i}`]?.footnote);
                    updateOrHide(`maps.map${i}.imageSources`, targetEntry.maps?.[`map${i}`]?.imageSources);
                    updateOrHide(`maps.map${i}.image`, targetEntry.maps?.[`map${i}`]?.image);
                }
                }
                if (contextEntry) {
                    // Updating or hiding general information fields
                    updateOrHide('ctxt.generalInformation.areaOfWork', ctxtEntry.generalInformation.areaOfWork);
                    updateOrHide('ctxt.generalInformation.city', ctxtEntry.generalInformation.city);
                    updateOrHide('ctxt.generalInformation.county', ctxtEntry.generalInformation.county);
                    updateOrHide('ctxt.generalInformation.neighborhood', ctxtEntry.generalInformation.neighborhood);
                    updateOrHide('ctxt.generalInformation.state', ctxtEntry.generalInformation.state);
        
                    // Updating or hiding timeline fields
                    for (let i = 1; i <= 10; i++) {
                        updateOrHide(`ctxt.timeline.event${i}.title`, ctxtEntry.timeline[`event${i}`]?.title);
                        updateOrHide(`ctxt.timeline.event${i}.year`, ctxtEntry.timeline[`event${i}`]?.year);
                        updateOrHide(`ctxt.timeline.event${i}.briefDescription`, ctxtEntry.timeline[`event${i}`]?.briefDescription);
                        updateOrHide(`ctxt.timeline.event${i}.sources`, ctxtEntry.timeline[`event${i}`]?.sources);
                    }
                    }
        
            }
        
            window.onload = fetchSchoolById;
        </script>


    </body>
</html>